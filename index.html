<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QR ì½”ë“œ ìŠ¤ìºë„ˆ</title>
  <script src="https://unpkg.com/html5-qrcode"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }

    .container {
      width: 100%;
      max-width: 500px;
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
      overflow: hidden;
      margin: 20px 0;
    }

    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px 20px;
      text-align: center;
    }

    .header h1 {
      font-size: 1.8rem;
      margin-bottom: 10px;
      font-weight: 600;
    }

    .header p {
      font-size: 0.9rem;
      opacity: 0.9;
    }

    .scanner-section {
      padding: 20px;
    }

    #reader {
      width: 100% !important;
      max-width: 100%;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }

    .result-section {
      padding: 20px;
      background: #f8f9fa;
      border-top: 1px solid #e9ecef;
    }

    .result-section h3 {
      color: #495057;
      margin-bottom: 15px;
      font-size: 1.1rem;
    }

    #result {
      background: white;
      padding: 15px;
      border-radius: 10px;
      border: 2px solid #e9ecef;
      min-height: 60px;
      word-break: break-all;
      font-size: 0.9rem;
      color: #495057;
    }

    .status {
      text-align: center;
      padding: 10px;
      color: #6c757d;
      font-size: 0.85rem;
    }

    .controls {
      display: flex;
      gap: 10px;
      margin-top: 15px;
      flex-wrap: wrap;
    }

    .btn {
      flex: 1;
      min-width: 120px;
      padding: 12px 20px;
      border: none;
      border-radius: 10px;
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .btn-secondary {
      background: #6c757d;
      color: white;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    /* ëª¨ë°”ì¼ ìµœì í™” */
    @media (max-width: 768px) {
      body {
        padding: 10px;
      }
      
      .container {
        margin: 10px 0;
        border-radius: 15px;
      }
      
      .header {
        padding: 20px 15px;
      }
      
      .header h1 {
        font-size: 1.5rem;
      }
      
      .scanner-section {
        padding: 15px;
      }
      
      .result-section {
        padding: 15px;
      }
      
      .controls {
        flex-direction: column;
      }
      
      .btn {
        min-width: auto;
      }
    }

    @media (max-width: 480px) {
      .header h1 {
        font-size: 1.3rem;
      }
      
      #result {
        font-size: 0.8rem;
        padding: 12px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ“± QR ì½”ë“œ ìŠ¤ìºë„ˆ</h1>
      <p>QR ì½”ë“œë¥¼ ì¹´ë©”ë¼ì— ë¹„ì¶°ì£¼ì„¸ìš”</p>
    </div>
    
    <div class="scanner-section">
      <div id="reader"></div>
      <div class="status" id="status">ì¹´ë©”ë¼ ì ‘ê·¼ ê¶Œí•œì„ í—ˆìš©í•´ì£¼ì„¸ìš”...</div>
    </div>
    
    <div class="result-section">
      <h3>ğŸ“‹ ìŠ¤ìº” ê²°ê³¼</h3>
      <div id="result">QR ì½”ë“œë¥¼ ìŠ¤ìº”í•˜ë©´ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</div>
      <div class="controls">
        <button class="btn btn-primary" onclick="startScanner()">ìŠ¤ìº” ì‹œì‘</button>
        <button class="btn btn-secondary" onclick="stopScanner()">ìŠ¤ìº” ì¤‘ì§€</button>
        <button class="btn btn-secondary" onclick="clearResult()">ê²°ê³¼ ì§€ìš°ê¸°</button>
      </div>
    </div>
  </div>

  <script>
    let html5QrcodeScanner = null;
    let isScanning = false;

    function onScanSuccess(decodedText, decodedResult) {
      document.getElementById('result').innerHTML = `
        <strong>âœ… ìŠ¤ìº” ì„±ê³µ!</strong><br>
        <span style="color: #28a745;">${decodedText}</span>
      `;
      document.getElementById('status').innerHTML = 'âœ… QR ì½”ë“œê°€ ì„±ê³µì ìœ¼ë¡œ ìŠ¤ìº”ë˜ì—ˆìŠµë‹ˆë‹¤!';
      document.getElementById('status').style.color = '#28a745';
      
      // ìŠ¤ìº” ì„±ê³µ í›„ ìë™ìœ¼ë¡œ ì¤‘ì§€í•˜ì§€ ì•Šê³  ê³„ì† ìŠ¤ìº”
      // í•„ìš”ì‹œ ì•„ë˜ ì£¼ì„ì„ í•´ì œí•˜ì„¸ìš”
      // stopScanner();
    }

    function onScanFailure(error) {
      // ì¼ë°˜ì ì¸ ìŠ¤ìº” ì‹¤íŒ¨ëŠ” ë¬´ì‹œ (QR ì½”ë“œê°€ ì—†ì„ ë•Œ)
      if (error && error.name !== 'NotFoundException') {
        console.warn(`QR ìŠ¤ìº” ì˜¤ë¥˜: ${error}`);
        document.getElementById('status').innerHTML = 'âš ï¸ ìŠ¤ìº” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
        document.getElementById('status').style.color = '#dc3545';
      }
    }

    function startScanner() {
      if (isScanning) return;
      
      try {
        html5QrcodeScanner = new Html5QrcodeScanner(
          "reader", 
          { 
            fps: 10, 
            qrbox: { width: 250, height: 250 },
            aspectRatio: 1.0,
            supportedScanTypes: [Html5QrcodeScanType.SCAN_TYPE_CAMERA]
          }
        );
        
        html5QrcodeScanner.render(onScanSuccess, onScanFailure);
        isScanning = true;
        document.getElementById('status').innerHTML = 'ğŸ“¹ ì¹´ë©”ë¼ê°€ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤. QR ì½”ë“œë¥¼ ë¹„ì¶°ì£¼ì„¸ìš”.';
        document.getElementById('status').style.color = '#007bff';
      } catch (error) {
        console.error('ìŠ¤ìºë„ˆ ì‹œì‘ ì˜¤ë¥˜:', error);
        document.getElementById('status').innerHTML = 'âŒ ì¹´ë©”ë¼ ì ‘ê·¼ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.';
        document.getElementById('status').style.color = '#dc3545';
      }
    }

    function stopScanner() {
      if (html5QrcodeScanner && isScanning) {
        html5QrcodeScanner.clear();
        html5QrcodeScanner = null;
        isScanning = false;
        document.getElementById('status').innerHTML = 'â¸ï¸ ìŠ¤ìºë„ˆê°€ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.';
        document.getElementById('status').style.color = '#6c757d';
      }
    }

    function clearResult() {
      document.getElementById('result').innerHTML = 'QR ì½”ë“œë¥¼ ìŠ¤ìº”í•˜ë©´ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.';
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ìœ¼ë¡œ ìŠ¤ìºë„ˆ ì‹œì‘
    window.addEventListener('load', function() {
      setTimeout(startScanner, 1000);
    });

    // í˜ì´ì§€ ì–¸ë¡œë“œ ì‹œ ìŠ¤ìºë„ˆ ì •ë¦¬
    window.addEventListener('beforeunload', function() {
      stopScanner();
    });
  </script>
</body>
</html>
